<!DOCTYPE html>
<html th:lang="${accessibility}" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="/layouts/default">
<head>
	<meta charset="utf-8">
	<title>디자인 레이어 그룹</title>
	<th:block layout:fragment="pageCustomStyle">
		<link rel="stylesheet" th:href="@{/css/{lang}/font/font.css(lang=${lang},cacheVersion=${contentCacheVersion})}" />
		<link rel="stylesheet" th:href="@{/images/{lang}/icon/glyph/glyphicon.css(lang=${lang},cacheVersion=${contentCacheVersion})}" />
		<link rel="stylesheet" th:href="@{/externlib/normalize/normalize.min.css(cacheVersion=${contentCacheVersion})}" />
		<link rel="stylesheet" th:href="@{/css/fontawesome-free-5.2.0-web/css/all.min.css(cacheVersion=${contentCacheVersion})}">
		<link rel="stylesheet" th:href="@{/externlib/jquery-ui-1.12.1/jquery-ui.min.css(cacheVersion=${contentCacheVersion})}" />
		<link rel="stylesheet" th:href="@{/css/{lang}/admin-style.css(lang=${lang},cacheVersion=${contentCacheVersion})}" />
	</th:block>
</head>
<body>
<th:block layout:fragment="pageCustomContent">
	<div class="site-body">
		<div class="container">
			<div class="site-content">
				<div th:replace="~{/fragments/sub-menu :: #subMenuWrap}"></div>
				<div class="page-area">
					<div th:replace="~{/fragments/page-header :: #pageHeaderWrap}"></div>
					<div class="page-content">
						<div style="height: 30px;"></div>
						<div class="list">
							<div class="list-header row">
								<div class="list-desc u-pull-left">
									<div class="button-group">
										<a href="#" onclick="openAll(); return false;" class="button">펼치기</a>
										<a href="#" onclick="closeAll(); return false;" class="button">접기</a>
									</div>
								</div>
								<div class="list-functions u-pull-right">
									<div class="button-group">
										<a href="/design-layer-group/input" class="button">디자인 레이어 그룹 등록</a>
									</div>
								</div>
							</div>
							<table class="list-table scope-col" summary="디자인 레이어 그룹 목록">
								<caption class="hiddenTag">디자인 레이어 그룹</caption>
								<col class="col-name"/>
								<col class="col-toggle"/>
								<col class="col-name"/>
								<col class="col-functions"/>
								<col class="col-functions"/>
								<col class="col-functions"/>
								<col class="col-date"/>
								<thead>
								<tr>
									<th scope="col">그룹명</th>
									<th scope="col">사용 여부</th>
									<th scope="col">등록자</th>
									<th scope="col">레이어</th>
									<th scope="col">순서</th>
									<th scope="col">편집</th>
									<th scope="col">등록일</th>
								</tr>
								</thead>
								<tbody>
<th:block th:if="${designLayerGroupList.empty}">
								<tr>
									<td colspan="7" class="col-none">디자인 레이어 그룹이 존재하지 않습니다.</td>
								</tr>
</th:block>
<th:block th:unless="${designLayerGroupList.empty}" th:each="designLayerGroup : ${designLayerGroupList}">
								<tr th:class="|rowId-${designLayerGroup.designLayerGroupId} rowDepth-${designLayerGroup.depth} rowAncestor-${designLayerGroup.ancestor} rowParent-${designLayerGroup.parent}|">
									<td class="col-key ellipsis" style="max-width: 300px;">
	<th:block th:with="paddingLeftValue = ${(designLayerGroup.depth -1)  * 40}">
										<span th:onclick="childrenDisplayToggle([[${designLayerGroup.designLayerGroupId}]], [[${designLayerGroup.depth}]],
											[[${designLayerGroup.ancestor}]], [[${designLayerGroup.parent}]]);"
											th:style="|padding-left: ${paddingLeftValue}px; font-size: 1.6em;|">
											<i th:id="|myArrow-${designLayerGroup.designLayerGroupId}|"
											   th:class="|fa fa-caret-right depthArrow-${designLayerGroup.depth} parentArrow-${designLayerGroup.parent}|" aria-hidden="true"></i>
										</span>&nbsp;
	</th:block>
	<th:block th:if="${designLayerGroup.depth == 1}">
										<span style="font-size: 1.5em; color: Dodgerblue;">
	</th:block>
	<th:block th:if="${designLayerGroup.depth == 2}">
										<span style="font-size: 1.5em; color: Mediumslateblue;">
	</th:block>
	<th:block th:if="${designLayerGroup.depth == 3}">
										<span style="font-size: 1.5em; color: Tomato;">
	</th:block>
	<th:block th:if="${designLayerGroup.depth == 4}">
										<span style="font-size: 1.5em; color: #82c91e;">
	</th:block>
	<th:block th:if="${designLayerGroup.depth == 5}">
										<span style="font-size: 1.5em; color: #f783ac;">
	</th:block>
											<i th:id="|myFolder-${designLayerGroup.designLayerGroupId}|"
											   th:class="|fa fa-folder depthFolder-${designLayerGroup.depth} parentFolder-${designLayerGroup.parent}|" aria-hidden="true"></i>
										</span>



<!--
	<th:block th:if="${designLayerGroup.depth == 1}">
										<span th:onclick="childrenDisplayToggle([[${designLayerGroup.depth}]], [[${designLayerGroup.designLayerGroupId}]], [[${designLayerGroup.ancestor}]]);"
											th:style="padding-left: |0|px; font-size: 1.6em;">
											<i th:id="|oneDepthArrow-${designLayerGroup.designLayerGroupId}|" class="fa fa-caret-right oneArrow" aria-hidden="true"></i>
										</span>&nbsp;
										<span style="font-size: 1.5em; color: Dodgerblue;">
											<i th:id="|oneDepthFolder-${designLayerGroup.designLayerGroupId}|" class="fa fa-folder oneFolder" aria-hidden="true"></i>
										</span>
	</th:block>
	<th:block th:if="${designLayerGroup.depth == 2} ">
										<span th:onclick="childrenDisplayToggle([[${designLayerGroup.depth}]], [[${designLayerGroup.designLayerGroupId}]], [[${designLayerGroup.ancestor}]]);"
											style="padding-left: 40px; font-size: 1.6em;">
											<i th:id="|twoDepthArrow-${designLayerGroup.designLayerGroupId}|" th:class="|fa fa-caret-right twoArrow ancestorArrow-${designLayerGroup.ancestor}|"
											   aria-hidden="true"></i>
										</span>&nbsp;
										<span style="font-size: 1.5em; color: Mediumslateblue;">
											<i th:id="|twoDepthArrow-${designLayerGroup.designLayerGroupId}|" th:class="|fa fa-folder twoFolder ancestorFolder-${designLayerGroup.ancestor}|"
											   aria-hidden="true"></i>
										</span>
	</th:block>
	<th:block th:if="${designLayerGroup.depth == 3}">
										<span style="padding-left: 80px; font-size: 1.5em; color: Tomato;">
											<i th:id="|threeDepthFolder-${designLayerGroup.designLayerGroupId}|" th:class="|fa fa-folder threeFolder ancestorFolder-${designLayerGroup.ancestor}|"
											   aria-hidden="true"></i>
										</span>
	</th:block>-->
										<span th:text="${designLayerGroup.designLayerGroupName}"></span>
									</td>
									<td class="col-type">
										<th:block th:if="${#bools.isTrue(designLayerGroup.available)}" th:text="사용"></th:block>
										<th:block th:if="${#bools.isFalse(designLayerGroup.available)}" th:text="미사용"></th:block>
									</td>
									<td class="col-type" th:text="${designLayerGroup.userId}"></td>
									<td class="col-type">
										<a th:href="@{/design-layer/list(searchOption=0,searchWord=design_layer_group_name,searchValue=${designLayerGroup.designLayerGroupName})}"
										   class="linkButton">보기</a>
									</td>
									<td class="col-type">
										<div class="button-group">
											<a href="#"
											   th:onclick="moveUp([[${designLayerGroup.designLayerGroupId}]], [[${designLayerGroup.viewOrder}]]); return false;"
											   class="button" style="text-decoration:none;">위로</a>
											<a href="#"
											   th:onclick="moveDown([[${designLayerGroup.designLayerGroupId}]], [[${designLayerGroup.viewOrder}]]); return false;"
											   class="button" style="text-decoration:none;">아래로</a>
										</div>
									</td>
									<td class="col-type">
										<a th:href="@{/design-layer-group/modify(designLayerGroupId=${designLayerGroup.designLayerGroupId})}"
										   class="image-button button-edit" th:text="#{modified}"></a>&nbsp;&nbsp;
										<a th:href="@{/design-layer-group/delete(designLayerGroupId=${designLayerGroup.designLayerGroupId})}"
										   class="image-button button-delete" th:text="#{delete}"
										   onclick="return deleteWarning();"></a>
									</td>
									<td class="col-date"
										th:text="${#temporals.format(designLayerGroup.insertDate, 'yyyy-MM-dd HH:mm:ss')}">
									</td>
									</tr>
</th:block>
								</tbody>
							</table>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</th:block>

<th:block layout:fragment="pageCustomScript">
	<script type="text/javascript" th:src="@{/externlib/jquery-3.3.1/jquery.min.js(cacheVersion=${contentCacheVersion})}"></script>
	<script type="text/javascript" th:src="@{/externlib/jquery-ui-1.12.1/jquery-ui.min.js(cacheVersion=${contentCacheVersion})}"></script>
	<script type="text/javascript" th:src="@{/js/{lang}/common.js(lang=${lang},cacheVersion=${contentCacheVersion})}"></script>
	<script type="text/javascript" th:src="@{/js/{lang}/message.js(lang=${lang},cacheVersion=${contentCacheVersion})}"></script>
	<script type="text/javascript" th:src="@{/js/navigation.js(cacheVersion=${contentCacheVersion})}"></script>

<script th:inline="javascript">
	//펼치기
	function openAll() {
		$(".rowDepth-5").show();
		$(".rowDepth-4").show();
		$(".rowDepth-3").show();
		$(".rowDepth-2").show();

		// fa-caret-right
		// fa-caret-down
		$(".depthArrow-1").removeClass("fa-caret-right");
		$(".depthArrow-1").addClass("fa-caret-down");
		$(".depthArrow-2").removeClass("fa-caret-right");
		$(".depthArrow-2").addClass("fa-caret-down");
		$(".depthArrow-3").removeClass("fa-caret-right");
		$(".depthArrow-3").addClass("fa-caret-down");
		$(".depthArrow-4").removeClass("fa-caret-right");
		$(".depthArrow-4").addClass("fa-caret-down");
		$(".depthArrow-5").removeClass("fa-caret-right");
		$(".depthArrow-5").addClass("fa-caret-down");

		$(".depthFolder-1").removeClass("fa-folder");
		$(".depthFolder-1").addClass("fa-folder-open");
		$(".depthFolder-2").removeClass("fa-folder");
		$(".depthFolder-2").addClass("fa-folder-open");
		$(".depthFolder-3").removeClass("fa-folder");
		$(".depthFolder-3").addClass("fa-folder-open");
		$(".depthFolder-4").removeClass("fa-folder");
		$(".depthFolder-4").addClass("fa-folder-open");
		$(".depthFolder-5").removeClass("fa-folder");
		$(".depthFolder-5").addClass("fa-folder-open");
	}

	// 접기
	function closeAll() {
		$(".rowDepth-5").hide();
		$(".rowDepth-4").hide();
		$(".rowDepth-3").hide();
		$(".rowDepth-2").hide();

		$(".depthArrow-1").removeClass("fa-caret-down");
		$(".depthArrow-1").addClass("fa-caret-right");
		$(".depthArrow-2").removeClass("fa-caret-down");
		$(".depthArrow-2").addClass("fa-caret-right");
		$(".depthArrow-3").removeClass("fa-caret-down");
		$(".depthArrow-3").addClass("fa-caret-right");
		$(".depthArrow-4").removeClass("fa-caret-down");
		$(".depthArrow-4").addClass("fa-caret-right");
		$(".depthArrow-5").removeClass("fa-caret-down");
		$(".depthArrow-5").addClass("fa-caret-right");

		$(".depthFolder-1").removeClass("fa-folder-open");
		$(".depthFolder-1").addClass("fa-folder");
		$(".depthFolder-2").removeClass("fa-folder-open");
		$(".depthFolder-2").addClass("fa-folder");
		$(".depthFolder-3").removeClass("fa-folder-open");
		$(".depthFolder-3").addClass("fa-folder");
		$(".depthFolder-4").removeClass("fa-folder-open");
		$(".depthFolder-4").addClass("fa-folder");
		$(".depthFolder-5").removeClass("fa-folder-open");
		$(".depthFolder-5").addClass("fa-folder");
	}

	// 화살표 클릭시
	function childrenDisplayToggle(id, depth, ancestor, parent) {
		var isOpen = true;
		var clickClass = $("#myArrow-" + id).attr("class");
		if (clickClass.indexOf("right") >= 0) {
			isOpen = false;
			// 닫힘 상태라 펼침
			$("#myArrow-" + id).removeClass("fa-caret-right");
			$("#myArrow-" + id).addClass("fa-caret-down");
			$("#myFolder-" + id).removeClass("fa-folder");
			$("#myFolder-" + id).addClass("fa-folder-open");
		} else {
			// 펼침 상태라 닫힘
			$("#myArrow-" + id).removeClass("fa-caret-down");
			$("#myArrow-" + id).addClass("fa-caret-right");
			$("#myFolder-" + id).removeClass("fa-folder-open");
			$("#myFolder-" + id).addClass("fa-folder");
		}

		if(depth !== 5) {
			// 자식을 찾으세요.
			$(".rowParent-" + id).each(function() {
				console.log("----------- id = " + $(this).attr("class"));
				if(isOpen) {
					// 내가 열려 있으면 자식을 닫고, 나도 닫는다.
				} else {

				}
				// row 자체를 display
			});
		}



		/*if ($(".parentClass-" + id).css("display") === "none") {
			// 자식이 접힌 상태
			$(".parentClass-" + id).show();

			$("#idArrow-" + id).removeClass("fa-caret-right");
			$("#idArrow-" + id).addClass("fa-caret-down");
			$("#idFolder-" + id).removeClass("fa-folder");
			$("#idFolder-" + id).addClass("fa-folder-open");

			// 자식을 펼침
			$(".arrow-" + id).removeClass("fa-caret-down");
			$(".arrow-" + id).addClass("fa-caret-right");
			$(".folder-" + id).removeClass("fa-folder-open");
			$(".folder-" + id).addClass("fa-folder");
		} else {
			// 자식이 펼친 상태
			if(depth != 1) $(".parentClass-" + parent).hide();
			$(".parentClass-" + id).hide();

			var clickClass = $("#idArrow-" + id).attr("class");
			if (clickClass.indexOf("right") >= 0) {
				// 닫힘 상태라 펼침
				$("#idArrow-" + id).removeClass("fa-caret-right");
				$("#idArrow-" + id).addClass("fa-caret-down");
				$("#idFolder-" + id).removeClass("fa-folder");
				$("#idFolder-" + id).addClass("fa-folder-open");
			} else {
				// 펼침 상태라 닫힘
				$("#idArrow-" + id).removeClass("fa-caret-down");
				$("#idArrow-" + id).addClass("fa-caret-right");
				$("#idFolder-" + id).removeClass("fa-folder-open");
				$("#idFolder-" + id).addClass("fa-folder");
			}

			$(".arrow-" + ancestor).removeClass("fa-caret-down");
			$(".arrow-" + ancestor).addClass("fa-caret-right");
			$(".folder-" + ancestor).removeClass("fa-folder-open");
			$(".folder-" + ancestor).addClass("fa-folder");
		}*/

		/*if (depth === 1) {
			if ($(".oneDepthParent-" + id).css("display") === "none") {
				// 접힌 상태
				$(".oneDepthParent-" + id).show();

				$("#oneDepthArrow-" + id).removeClass("fa-caret-right");
				$("#oneDepthArrow-" + id).addClass("fa-caret-down");
				$("#oneDepthFolder-" + id).removeClass("fa-folder");
				$("#oneDepthFolder-" + id).addClass("fa-folder-open");

				$(".ancestorArrow-" + ancestor).removeClass("fa-caret-down");
				$(".ancestorArrow-" + ancestor).addClass("fa-caret-right");
				$(".ancestorFolder-" + ancestor).removeClass("fa-folder-open");
				$(".ancestorFolder-" + ancestor).addClass("fa-folder");
			} else {
				// 펼친 상태
				$(".ancestor-" + ancestor).hide();
				$(".oneDepthParent-" + id).hide();

				var clickClass = $("#oneDepthArrow-" + id).attr("class");
				if (clickClass.indexOf("right") >= 0) {
					// 닫힘 상태라 펼침
					$("#oneDepthArrow-" + id).removeClass("fa-caret-right");
					$("#oneDepthArrow-" + id).addClass("fa-caret-down");
					$("#oneDepthFolder-" + id).removeClass("fa-folder");
					$("#oneDepthFolder-" + id).addClass("fa-folder-open");
				} else {
					// 펼침 상태라 닫힘
					$("#oneDepthArrow-" + id).removeClass("fa-caret-down");
					$("#oneDepthArrow-" + id).addClass("fa-caret-right");
					$("#oneDepthFolder-" + id).removeClass("fa-folder-open");
					$("#oneDepthFolder-" + id).addClass("fa-folder");
				}

				$(".ancestorArrow-" + ancestor).removeClass("fa-caret-down");
				$(".ancestorArrow-" + ancestor).addClass("fa-caret-right");
				$(".ancestorFolder-" + ancestor).removeClass("fa-folder-open");
				$(".ancestorFolder-" + ancestor).addClass("fa-folder");
			}
		} else if (depth === 2) {
			if ($(".twoDepthParent-" + id).css("display") === "none") {
				// 접힌 상태
				$(".twoDepthParent-" + id).show();

				$("#twoDepthArrow-" + id).removeClass("fa-caret-right");
				$("#twoDepthArrow-" + id).addClass("fa-caret-down");
				$("#twoDepthFolder-" + id).removeClass("fa-folder");
				$("#twoDepthFolder-" + id).addClass("fa-folder-open");
			} else {
				// 펼친 상태
				$(".twoDepthParent-" + id).hide();

				var clickClass = $("#twoDepthArrow-" + id).attr("class");
				if (clickClass.indexOf("right") >= 0) {
					// 닫힘 상태라 펼침
					$("#twoDepthArrow-" + id).removeClass("fa-caret-right");
					$("#twoDepthArrow-" + id).addClass("fa-caret-down");
					$("#twoDepthFolder-" + id).removeClass("fa-folder");
					$("#twoDepthFolder-" + id).addClass("fa-folder-open");
				} else {
					// 펼침 상태라 닫힘
					$("#twoDepthArrow-" + id).removeClass("fa-caret-down");
					$("#twoDepthArrow-" + id).addClass("fa-caret-right");
					$("#twoDepthFolder-" + id).removeClass("fa-folder-open");
					$("#twoDepthFolder-" + id).addClass("fa-folder");
				}
			}
		}*/
	}


	// 자식을 펼침
	function openChild(id, depth) {
		if(depth === 5) {

		} else {

		}
	}

	// 자식을 닫음
	function closeChild(id, depth) {
		if(depth === 5) {
			// 자식
		} else {

		}
	}

	// 위로 이동
	var upFlag = true;
	function moveUp(id, viewOrder) {
		if (upFlag) {
			upFlag = false;
			if (viewOrder === 1) {
				alert("제일 처음 입니다.");
				upFlag = true;
				return;
			}

			var formData = "updateType=UP";
			$.ajax({
				url: "/design-layer-groups/view-order/" + id,
				type: "POST",
				headers: {"X-Requested-With": "XMLHttpRequest"},
				data: formData,
				success: function (msg) {
					if (msg.statusCode <= 200) {
						alert(JS_MESSAGE["update"]);
						window.location.reload();
						upFlag = true;
						openAll();
					} else {
						if (msg.errorCode === "design.layer.group.view-order.invalid") {
							alert("순서를 변경할 수 없습니다.");
						} else {
							alert(JS_MESSAGE[msg.errorCode]);
						}
						console.log("---- " + msg.message);
						upFlag = true;
					}
				},
				error: function (request, status, error) {
					alert(JS_MESSAGE["ajax.error.message"]);
					upFlag = true;
				}
			});
		} else {
			alert("진행 중입니다.");
		}
	}

	// 아래로 이동
	var downFlag = true;
	function moveDown(id, viewOrder) {
		if (downFlag) {
			downFlag = false;
			var formData = "updateType=DOWN";
			$.ajax({
				url: "/design-layer-groups/view-order/" + id,
				type: "POST",
				headers: {"X-Requested-With": "XMLHttpRequest"},
				data: formData,
				success: function (msg) {
					if (msg.statusCode <= 200) {
						alert(JS_MESSAGE["update"]);
						window.location.reload();
						downFlag = true;
						openAll();
					} else {
						if (msg.errorCode === "design.layer.group.view-order.invalid") {
							alert("순서를 변경할 수 없습니다.");
						} else {
							alert(JS_MESSAGE[msg.errorCode]);
						}
						console.log("---- " + msg.message);
						downFlag = true;
					}
				},
				error: function (request, status, error) {
					alert(JS_MESSAGE["ajax.error.message"]);
					downFlag = true;
				}
			});
		} else {
			alert("진행 중입니다.");
		}
	}
</script>
</th:block>
</body>
</html>